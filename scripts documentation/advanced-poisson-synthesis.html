<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Advanced Poisson Synthesis — User Guide</title>
<style>
html,body{background:#fff;color:#111;margin:0;font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Inter,sans-serif}
.wrap{max-width:900px;margin:40px auto;padding:0 20px}
h1,h2,h3{line-height:1.25;margin-top:1.25rem} h1{font-size:2rem;margin-top:0}
p.lead{color:#444;margin-top:.25rem}
.meta{color:#555;font-size:.95rem;display:flex;gap:1rem;flex-wrap:wrap}
.panel{background:#fafafa;border:1px solid #e5e7eb;border-radius:10px;padding:14px 16px}
.toc a{color:#0b57d0;text-decoration:none} .toc a:hover{text-decoration:underline}
a{color:#0b57d0}
code,pre{background:#f6f8fa;border:1px solid #e5e7eb;border-radius:6px} code{padding:.15em .35em} pre{padding:12px;overflow:auto}
table{width:100%;border-collapse:collapse;background:#fff;border:1px solid #e5e7eb;border-radius:8px;overflow:hidden}
th,td{padding:10px 12px;border-bottom:1px solid #e5e7eb;vertical-align:top} th{text-align:left;background:#f8fafc} tr:last-child td{border-bottom:none}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:12px}
footer{margin-top:2rem;color:#555}
.kbd{background:#f6f8fa;border:1px solid #e5e7eb;border-radius:6px;padding:2px 6px;font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace}
</style></head>
<body><main class="wrap">
<header>
  <h1>Advanced Poisson Synthesis — User Guide</h1>
  <p class="lead">Praat script.</p>
  <div class="meta"><span><strong>Author:</strong> Shai Cohen</span> <span><strong>Affiliation:</strong> Department of Music, Bar-Ilan University, Israel</span> <span><strong>Version:</strong> 0.1 (2025)</span> <span><strong>License:</strong> MIT License</span> <span><strong>Repo:</strong> <a href="https://github.com/ShaiCohen-ops/Praat-plugin_AudioTools">https://github.com/ShaiCohen-ops/Praat-plugin_AudioTools</a></span></div>
</header>

<section class="panel toc" aria-label="Table of contents" style="margin-top:16px">
  <strong>Contents:</strong>
  <div class="grid" style="margin-top:8px">
    <a href="#what">What this does</a>
    <a href="#quickstart">Quick start</a>
    <a href="#params">Parameters</a>
    <a href="#modes">Synthesis modes</a>
    <a href="#spatial">Spatial modes</a>
    <a href="#outputs">Outputs</a>
  </div>
</section>

<section id="what">
  <h2>What this does</h2>
  <p>Praat script.</p>
  <p><em><strong>Process Description:</strong> The core concept is to create sound textures based on random probability, where the timing of thousands of tiny sound events (grains) is governed by a Poisson Point Process rather than a fixed rhythm. This is ideal for generating natural-sounding, non-periodic textures like rain, crackling energy, or vast ambient noise.</em></p>
<p><em><strong>Technical details:</strong> This Praat script implements a stochastic granular synthesis engine based on Poisson point processes, generating asynchronous grain clouds where event timing follows exponential inter-arrival distributions characteristic of memoryless random processes. The algorithm employs Praat's native Poisson process generator to create temporal point sequences with user-specified rate parameters (λ events/second), where the probability of exactly k events in time interval t follows P(k) = (λt)^k × e^(-λt) / k! and inter-event intervals are exponentially distributed with mean 1/λ. Each synthesis mode implements distinct rate structures and grain parameter mappings: Standard mode linearly interpolates rates across layers from low_rate to high_rate, creating density stratification; Dense Granular uses 1.5× high_rate with short grains (30-110 ms) for continuous texture; Sparse Atmospheric employs 0.5× low_rate with extended grains (300-800 ms) for ambient pads; Rhythmic Pulses uses mid-range rates with harmonic frequency relationships (base_freq × layer) and medium durations (80-200 ms); and Chaotic Scatter applies fully randomized rate selection per layer for maximum temporal unpredictability. At each Poisson-generated time point, the algorithm synthesizes an individual grain through additive injection: a sinusoidal oscillator at randomized frequency (base ± range) is multiplied by a raised-cosine (Hann) envelope (1 - cos(2πt/duration))/2 to ensure smooth onset/offset without spectral leakage, then added to the output buffer through segment extraction, formula-based addition, and conditional replacement. This segment-wise modification approach circumvents Praat's lack of direct sample indexing by extracting temporal slices, performing additive synthesis via self + Sound_grain[] array reference, then using conditional formulas with column-offset indexing to splice modified segments back into the master output. Grain frequencies are drawn from uniform distributions within specified ranges, with mode-specific offsets creating spectral stratification across layers (e.g., Dense mode uses base × (0.5 + layer × 0.3) for frequency spreading). The optional parameter randomization applies multiplicative variation (typically 60-140% nominal values) to rates, frequencies, and durations, preventing temporal periodicity and spectral clustering that would otherwise emerge from deterministic parameter assignment. The Poisson temporal structure ensures true stochastic independence—unlike periodic grain schedulers, successive events are memoryless with no correlation, producing organic, natural-sounding textures that avoid mechanical repetition. Four spatial modes (matching previous systems) provide stereo imaging through complementary filtering, circular panning at 0.25 Hz, or binaural simulation. The system performs grain-by-grain accumulation allowing unlimited constructive interference, applies linear boundary fades, and includes optional peak normalization to 0.9. This architecture produces textures ranging from sparse, shimmering clouds (mode 3) through dense, continuous drones (mode 2) to rhythmically pulsating masses (mode 4), suitable for algorithmic composition, generative ambient music, stochastic sound design, and applications requiring non-periodic temporal structures that maintain statistical regularity while exhibiting moment-to-moment unpredictability characteristic of natural acoustic phenomena like rain, insect swarms, and crowd noise.</em></p>

</section>

<section id="quickstart">
  <h2>Quick start</h2>
  <ol>
    <li>In <strong>Praat</strong>, select a <strong>Sound</strong> object.</li>
    <li><span class="kbd">Run script…</span> → <code>Advanced Poisson Synthesis.praat</code>.</li>
    <li>Set parameters and click <strong>OK</strong>.</li>
    <li>Output object appears (see <em>Outputs</em>).</li>
  </ol>
</section>

<section id="params">
  <h2>Parameters (form fields)</h2>
  <table><thead><tr><th>Name (GUI)</th><th>Type</th><th>Default</th></tr></thead><tbody>
<tr><td><strong>Duration_(sec)</strong></td><td>positive</td><td>12</td></tr>
<tr><td><strong>Base_frequency_(Hz)</strong></td><td>positive</td><td>100</td></tr>
<tr><td><strong>Frequency_range_(Hz)</strong></td><td>positive</td><td>300</td></tr>
<tr><td><strong>Low_rate_(events</strong></td><td>positive</td><td>/sec) 3</td></tr>
<tr><td><strong>High_rate_(events</strong></td><td>positive</td><td>/sec) 15</td></tr>
<tr><td><strong>Number_of_layers</strong></td><td>integer</td><td>3</td></tr>
<tr><td><strong>Randomize_parameters</strong></td><td>boolean</td><td>1</td></tr>
<tr><td><strong>Fade_time_(sec)</strong></td><td>positive</td><td>2</td></tr>
<tr><td><strong>Normalize_output</strong></td><td>boolean</td><td>1</td></tr>
</tbody></table>
</section>

<section id="modes"><h2>Synthesis modes</h2><ul><li><strong>Three Layer Standard</strong></li>
<li><strong>Dense Granular</strong></li>
<li><strong>Sparse Atmospheric</strong></li>
<li><strong>Rhythmic Pulses</strong></li>
<li><strong>Chaotic Scatter</strong></li></ul></section>

<section id="spatial"><h2>Spatial modes</h2><ul><li><strong>Mono</strong></li>
<li><strong>Stereo Wide</strong></li>
<li><strong>Rotating</strong></li>
<li><strong>Binaural</strong></li></ul></section>

<section id="outputs">
  <h2>Outputs</h2>
  <ul>
    <li><strong>Object name:</strong> segment</li>
    <li><strong>Sample rate:</strong> 44100 Hz</li>
    <li><strong>Normalization:</strong> Final peak scaled to 0.9</li>
  </ul>
</section>

<footer><small>Generated 2025-10-08 • Source: <code>Advanced Poisson Synthesis.praat</code></small></footer>

</main></body></html>
